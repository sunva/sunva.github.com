<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>计时器</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <style>
		body{ background-color:#333; }
		.start { border:1px solid #999; background-color:#fff; }
		.line{ position:absolute; left:5%; top:50%; margin-top:-30px; width:90%; height:60px; background-color:#444; border-radius:10px;}
		.set{ position:absolute; left:25%; top:50%; margin-top:-30px; width:50%; height:60px; background-color:rgba(255,255,255,0.05); text-align:center; }
		.time-m{ background:none; border:none; color:#999; height:60px; font-size:18px; }
    </style>
  </head>
  <body>
  
  <div class="line"></div>
  <div class="set">
  	<input class="time-m" type="time" value="00:30">
  </div>
  
	<script src="javascripts/jquery.min.js"></script>
    <script src="javascripts/scale.fix.js"></script>
<script>
$(function(){
	var lineH = 90;
	var flag = false;
	$(".time-m").focus().change(function(e) {
	//$(".line").click(function(e) {
		if(flag){return;}
		flag = true;
		$(".line").css({"background-color":"#888"});
		console.log(parseInt($(".time-m").val().split(":")[0]));
		var time_m = parseInt($(".time-m").val().split(":")[0]);
		var time_s = parseInt($(".time-m").val().split(":")[1]);
		
		var itv = setInterval(function(){
			lineH-=1;
			$(".line").css({"width":lineH+"%","background-color":"#888"});
			if(lineH<=0){
				clearInterval(itv);
				setTimeout(function(){
					$(".line").css({"background-color":"#444"}).animate({"width":"90%"},500);
					lineH = 90;
					flag = false;
				},500);
			}
		},(60*time_m+time_s)*10);
	});

});
</script>
  </body>
</html>
